DECLARE @PATH VARCHAR(255)
DECLARE @DATE VARCHAR(255)
--SET @DATE=CAST(DATEPART(YYYY,GETDATE()) AS VARCHAR)+'_'+CAST(DATEPART(MM,GETDATE()) AS VARCHAR)+'_'+CAST(DATEPART(DD,GETDATE()) AS VARCHAR)
SET @DATE=CONVERT(nvarchar(10), DATEADD(wk, DATEDIFF(wk,0,DATEADD(dd, -1, getdate()) ), 0),121)
SET @PATH = 'D:\dbbak\'+@DATE+'\'
BEGIN
    --因为XP_CMDSHELL 函数的参数不允许使用变量拼接  所以使用EXEC(SQL)的方法
    DECLARE @EX NVARCHAR(255)
    SET @EX='EXEC XP_CMDSHELL ''MKDIR '+@PATH+''''
    EXEC(@EX)
END
